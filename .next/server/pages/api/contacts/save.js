"use strict";(()=>{var e={};e.id=480,e.ids=[480],e.modules={1183:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>l,routeModule:()=>d});var a={};r.r(a),r.d(a,{default:()=>m});var n=r(3480),s=r(8667),o=r(6435),i=r(9194),c=r(8011);async function m(e,t){if("POST"!==e.method)return t.setHeader("Allow",["POST"]),t.status(405).json({message:`Method ${e.method} Not Allowed`});let{name:r,email:a,phone:n,company:s,message:o}=e.body;if(!r||!a||!o)return t.status(400).json({message:"Bad Request",error:"Name, email, and message are required fields."});if(!function(e){if(!e||"string"!=typeof e||e.length>254||e.length<3)return!1;let t=e.split("@");if(2!==t.length)return!1;let[r,a]=t;return 0!==r.length&&!(r.length>64)&&0!==a.length&&!(a.length>253)&&!!a.includes(".")&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}(a))return t.status(400).json({message:"Bad Request",error:"Invalid email address format."});if(r.length>100)return t.status(400).json({message:"Bad Request",error:"Name cannot exceed 100 characters."});if(o.length>5e3)return t.status(400).json({message:"Bad Request",error:"Message cannot exceed 5000 characters."});if(n&&n.length>20)return t.status(400).json({message:"Bad Request",error:"Phone number cannot exceed 20 characters."});if(s&&s.length>100)return t.status(400).json({message:"Bad Request",error:"Company name cannot exceed 100 characters."});try{await (0,i.A)();let e=new c.A({name:r.trim(),email:a.trim().toLowerCase(),phone:n?.trim()||void 0,company:s?.trim()||void 0,message:o.trim()}),m=await e.save();return t.status(201).json({message:"Contact message saved successfully!",data:{id:m._id,name:m.name,email:m.email,createdAt:m.createdAt}})}catch(e){if(console.error("Error saving contact message to database:",e),"ValidationError"===e.name){let r=Object.values(e.errors).map(e=>e.message).join(", ");return t.status(400).json({message:"Validation error",error:r})}if(11e3===e.code)return t.status(400).json({message:"Duplicate entry",error:"A contact with this email already exists."});return t.status(500).json({message:"Error saving contact message",error:e.message||"Internal Server Error"})}}let l=(0,o.M)(a,"default"),u=(0,o.M)(a,"config"),d=new n.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/contacts/save",pathname:"/api/contacts/save",bundlePath:"",filename:""},userland:a})},3480:(e,t,r)=>{e.exports=r(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6037:e=>{e.exports=require("mongoose")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8011:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(6037),n=r.n(a);let s=new a.Schema({name:{type:String,required:[!0,"Name is required"],trim:!0,maxlength:[100,"Name cannot exceed 100 characters"]},email:{type:String,required:[!0,"Email is required"],trim:!0,lowercase:!0,match:[/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Please provide a valid email address"]},phone:{type:String,trim:!0,maxlength:[20,"Phone number cannot exceed 20 characters"]},company:{type:String,trim:!0,maxlength:[100,"Company name cannot exceed 100 characters"]},message:{type:String,required:[!0,"Message is required"],trim:!0,maxlength:[5e3,"Message cannot exceed 5000 characters"]},status:{type:String,enum:["Received","Progress","Done"],default:"Received"},is_read:{type:Boolean,default:!1}},{timestamps:!0});s.index({email:1}),s.index({createdAt:-1});let o=n().models.Contact||n().model("Contact",s)},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9194:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(6037),n=r.n(a);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=o);let i=async function(){if(o.conn)return o.conn;o.promise||(o.promise=n().connect(s,{bufferCommands:!1}));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=1183);module.exports=r})();