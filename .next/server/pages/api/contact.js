"use strict";(()=>{var e={};e.id=409,e.ids=[409],e.modules={3480:(e,r,n)=>{e.exports=n(5600)},5377:(e,r,n)=>{n.r(r),n.d(r,{config:()=>g,default:()=>p,routeModule:()=>A});var t={};n.r(t),n.d(t,{default:()=>d});var s=n(3480),o=n(8667),a=n(6435);let i=require("nodemailer");var l=n.n(i),c=n(9194),m=n(8011);function u(e){if(!e||"string"!=typeof e||e.length>254||e.length<3)return!1;let r=e.split("@");if(2!==r.length)return!1;let[n,t]=r;return 0!==n.length&&!(n.length>64)&&0!==t.length&&!(t.length>253)&&!!t.includes(".")&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}async function d(e,r){if("POST"!==e.method)return r.setHeader("Allow",["POST"]),r.status(405).json({message:`Method ${e.method} Not Allowed`});let{name:n,email:t,phone:s,company:o,message:a}=e.body;if(!n||!t||!a)return r.status(400).json({message:"Bad Request",error:"Name, email, and message are required."});if(!u(t))return r.status(400).json({message:"Bad Request",error:"Invalid email address format."});if(!process.env.GMAIL_EMAIL||!process.env.GMAIL_APP_PASSWORD)return console.error("Missing email configuration. Please set GMAIL_EMAIL and GMAIL_APP_PASSWORD in your environment variables."),r.status(500).json({message:"Server configuration error",error:"Email service is not properly configured."});if(!u(process.env.GMAIL_EMAIL))return console.error("Invalid GMAIL_EMAIL format in environment variables."),r.status(500).json({message:"Server configuration error",error:"Invalid Gmail email configuration."});let i=process.env.GMAIL_EMAIL;process.env.CONTACT_FORM_RECEIVE_EMAIL&&(u(process.env.CONTACT_FORM_RECEIVE_EMAIL)?i=process.env.CONTACT_FORM_RECEIVE_EMAIL:console.warn("Invalid CONTACT_FORM_RECEIVE_EMAIL format. Using GMAIL_EMAIL as fallback."));let d=u(i)&&i!==process.env.GMAIL_EMAIL?i:process.env.GMAIL_EMAIL,p=l().createTransport({service:"gmail",auth:{user:process.env.GMAIL_EMAIL,pass:process.env.GMAIL_APP_PASSWORD}}),g={from:d,replyTo:t,to:i,subject:`New Contact Form Submission from ${n}${o?` (${o})`:""}`,text:`Name: ${n}
Email: ${t}
Phone: ${s||"N/A"}
Company: ${o||"N/A"}
Message: ${a}`,html:`
      <div style="font-family: sans-serif; line-height: 1.6;">
        <h2 style="color: #333;">New Contact Form Submission</h2>
        <p><strong>Name:</strong> ${n}</p>
        <p><strong>Email:</strong> <a href="mailto:${t}">${t}</a></p>
        <p><strong>Phone:</strong> ${s||"N/A"}</p>
        <p><strong>Company:</strong> ${o||"N/A"}</p>
        <p><strong>Message:</strong></p>
        <p style="white-space: pre-wrap; background-color: #f9f9f9; padding: 10px; border-radius: 4px;">${a}</p>
      </div>
    `};try{await (0,c.A)();let e=new m.A({name:n,email:t,phone:s||void 0,company:o||void 0,message:a});await e.save();try{await p.sendMail(g)}catch(e){console.error("Error sending email (message saved to database):",e)}return r.status(200).json({message:"Message received and saved successfully!"})}catch(e){if(console.error("Error processing contact form:",e),"ValidationError"===e.name)return r.status(400).json({message:"Validation error",error:Object.values(e.errors).map(e=>e.message).join(", ")});return r.status(500).json({message:"Error processing request",error:e.message||"Internal Server Error"})}}let p=(0,a.M)(t,"default"),g=(0,a.M)(t,"config"),A=new s.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/contact",pathname:"/api/contact",bundlePath:"",filename:""},userland:t})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6037:e=>{e.exports=require("mongoose")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,n){return n in r?r[n]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,n)):"function"==typeof r&&"default"===n?r:void 0}}})},8011:(e,r,n)=>{n.d(r,{A:()=>a});var t=n(6037),s=n.n(t);let o=new t.Schema({name:{type:String,required:[!0,"Name is required"],trim:!0,maxlength:[100,"Name cannot exceed 100 characters"]},email:{type:String,required:[!0,"Email is required"],trim:!0,lowercase:!0,match:[/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Please provide a valid email address"]},phone:{type:String,trim:!0,maxlength:[20,"Phone number cannot exceed 20 characters"]},company:{type:String,trim:!0,maxlength:[100,"Company name cannot exceed 100 characters"]},message:{type:String,required:[!0,"Message is required"],trim:!0,maxlength:[5e3,"Message cannot exceed 5000 characters"]},status:{type:String,enum:["Received","Progress","Done"],default:"Received"}},{timestamps:!0});o.index({email:1}),o.index({createdAt:-1});let a=s().models.Contact||s().model("Contact",o)},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return n}});var n=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9194:(e,r,n)=>{n.d(r,{A:()=>i});var t=n(6037),s=n.n(t);let o=process.env.MONGODB_URI;if(!o)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=a);let i=async function(){if(a.conn)return a.conn;a.promise||(a.promise=s().connect(o,{bufferCommands:!1}));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}}};var r=require("../../webpack-api-runtime.js");r.C(e);var n=r(r.s=5377);module.exports=n})();